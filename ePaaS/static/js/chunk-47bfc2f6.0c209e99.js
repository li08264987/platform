(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-47bfc2f6"],{4408:function(e,a,t){"use strict";var n=t("e33d"),l=t.n(n);l.a},"5e84":function(e,a,t){"use strict";var n=t("9287"),l=t.n(n);l.a},9287:function(e,a,t){},e33d:function(e,a,t){},ecd8:function(e,a,t){"use strict";t.r(a);var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"warningData-container"},[t("div",{staticClass:"search-container"},[t("div",{staticClass:"tabs-container"},[t("div",{staticClass:"tab tab-dealed",class:{active:e.dealedActive},attrs:{"data-id":"dealed"},on:{click:e.handleTabClick}},[e._v("已处理")]),e._v(" "),t("div",{staticClass:"tab tab-dealing",class:{active:e.dealingActive},attrs:{"data-id":"dealing"},on:{click:e.handleTabClick}},[e._v("未处理")])]),e._v(" "),t("div",{staticClass:"search-condition"},[t("el-date-picker",{staticStyle:{display:"inline-block"},attrs:{type:e.searchForm.dateType,"range-separator":"至",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期",placeholder:"选择时间","suffix-icon":"el-icon-search"},model:{value:e.searchForm.date,callback:function(a){e.$set(e.searchForm,"date",a)},expression:"searchForm.date"}}),e._v(" "),t("el-button",{staticClass:"btn-query",staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:e.dateSearch}},[e._v("查询")]),e._v(" "),t("el-input",{staticStyle:{width:"212px"},attrs:{placeholder:"请输入系统名称搜索","suffix-icon":"el-icon-search"},model:{value:e.searchForm.searchText,callback:function(a){e.$set(e.searchForm,"searchText",a)},expression:"searchForm.searchText"}}),e._v(" "),t("el-button",{staticClass:"btn-search",attrs:{type:"primary"},on:{click:e.nameSearch}},[e._v("搜索")]),e._v(" "),t("el-button",{staticClass:"btn-export",attrs:{loading:e.downloadLoading},on:{click:e.onExport}},[e._v("导出")])],1)]),e._v(" "),t("div",{staticClass:"table-container"},[t("Table",{directives:[{name:"show",rawName:"v-show",value:e.dealedTable,expression:"dealedTable"}],ref:"dealedWarningDataTable",attrs:{height:750,border:e.border,"show-operation":e.showOperation,data:e.pageResult,columns:e.columns},on:{findPage:e.findPage,handleEdit:e.handleEdit,handleDelete:e.handleDelete}}),e._v(" "),t("Table",{directives:[{name:"show",rawName:"v-show",value:e.dealingTable,expression:"dealingTable"}],ref:"dealingWarningDataTable",attrs:{height:750,border:e.border,"show-operation":e.showOperation,data:e.dealingPageResult,columns:e.columns},on:{findPage:e.findDealingPage,handleEdit:e.handleEdit,handleDelete:e.handleDelete}})],1)])},l=[],i=(t("20d6"),function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{attrs:{id:"table-container"}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","font-size":"14px"},attrs:{data:e.data.content,"highlight-current-row":e.highlightCurrentRow,border:e.border,stripe:e.stripe,"show-overflow-tooltip":e.showOverflowTooltip,"max-height":e.maxHeight,height:e.height,size:e.size,align:e.align,"header-cell-style":{background:"#F1F4FD"}},on:{"selection-change":e.selectionChange,"current-change":e.handleCurrentChange}},[t("el-table-column",{attrs:{prop:"sheBeiVaribleName",label:"设备变量名称","min-width":"50","header-align":"center",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"alarmValue",label:"设定报警值","min-width":"50","header-align":"center",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"state",label:"处理状态","min-width":"50","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.row;return[t("span",{style:0===n.stateCode?"color:#F5222D;":"color:#606266;"},[e._v(e._s(n.state))])]}}],null,!1,2235348708)}),e._v(" "),e._e(),e._v(" "),t("el-table-column",{attrs:{prop:"alarmTime",label:"报警时间","min-width":"50",sortable:!0,"header-align":"center",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"sheBeiName",label:"设备名称","min-width":"50","header-align":"center",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"alarmLevel",label:"报警级别","min-width":"50","header-align":"center",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"currentValue",label:"实际值","min-width":"50","header-align":"center",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"alarmUnit",label:"数据单位","min-width":"50","header-align":"center",align:"center"}}),e._v(" "),e._e(),e._v(" "),e.showOperation?t("el-table-column",{attrs:{label:"操作","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("Button",{attrs:{label:"已处理",size:e.size,type:e.buttonType.success,disabled:1===a.row.stateCode},on:{click:function(t){return e.handleDealing(a.$index,a.row)}}}),e._v(" "),t("Button",{attrs:{label:"删除",size:e.size,type:e.buttonType.warning},on:{click:function(t){return e.handleDelete(a.$index,a.row)}}})]}}],null,!1,4033581766)}):e._e()],1),e._v(" "),t("div",{staticClass:"toolbar"},[t("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper","current-page":e.pageRequest.pageNum,"page-size":e.pageRequest.pageSize,total:e.data.totalSize},on:{"update:total":function(a){return e.$set(e.data,"totalSize",a)},"current-change":e.refreshPageRequest}})],1)],1)}),s=[],r=(t("c5f6"),function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("el-button",{attrs:{size:e.size,type:e.type,icon:e.icon,loading:e.loading,disabled:e.disabled},on:{click:e.handleClick}},[e._v("\n  "+e._s(e.label)+"\n")])}),o=[],d={name:"Button",props:{label:{type:String,default:""},icon:{type:String,default:""},size:{type:String,default:"mini"},type:{type:String,default:null},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},perms:{type:Boolean,default:null}},data:function(){return{}},mounted:function(){},methods:{handleClick:function(){this.$emit("click",{})}}},c=d,u=t("2877"),h=Object(u["a"])(c,r,o,!1,null,null,null),g=h.exports,p={name:"Table",components:{Button:g},props:{columns:{type:Array,default:null},data:{type:Object,default:null},size:{type:String,default:"mini"},align:{type:String,default:"left"},maxHeight:{type:Number,default:800},height:{type:Number,default:250},showOperation:{type:Boolean,default:!0},border:{type:Boolean,default:!1},stripe:{type:Boolean,default:!0},highlightCurrentRow:{type:Boolean,default:!0},showOverflowTooltip:{type:Boolean,default:!0},showBatchDelete:{type:Boolean,default:!0}},data:function(){return{pageRequest:{pageNum:1,pageSize:15},loading:!1,selections:[],buttonType:{success:"success",warning:"warning"}}},mounted:function(){this.refreshPageRequest(1)},methods:{refreshPageRequest:function(e){this.pageRequest.pageNum=e,this.findPage(),this.findDealingPage()},findPage:function(){var e=this;this.loading=!0;var a=function(a){e.loading=!1};this.$emit("findPage",{pageRequest:this.pageRequest,callback:a})},findDealingPage:function(){var e=this;this.loading=!0;var a=function(a){e.loading=!1};this.$emit("findDealingPage",{pageRequest:this.pageRequest,callback:a})},selectionChange:function(e){this.selections=e,this.$emit("selectionChange",{selections:e})},handleCurrentChange:function(e){this.$emit("handleCurrentChange",{val:e})},handleDealing:function(e,a){this.$emit("handleEdit",{index:e,row:a})},handleDelete:function(e,a){this.delete({index:e,row:a})},delete:function(e){var a=this;this.$confirm("确认屏蔽所选内容？","提示",{type:"warning"}).then((function(){var t=function(e){1===e.state?(a.$message({message:"删除成功",type:"success"}),a.findPage()):a.$message({message:"删除失败",type:"error"}),a.loading=!1};a.$emit("handleDelete",{rowInfor:e,callback:t}),a.loading=!1})).catch((function(){}))}}},m=p,f=(t("4408"),Object(u["a"])(m,i,s,!1,null,null,null)),b=f.exports,v=t("a48f");function w(e){return Object(v["a"])({url:"/diagnose/warningData/getWarningDataList",method:"post",params:e})}function y(e){return Object(v["a"])({url:"/diagnose/warningData/updateWarningState",method:"post",params:e})}function R(e){return Object(v["a"])({url:"/diagnose/warningData/deleteWarningData",method:"post",params:e})}function T(e){return Object(v["a"])({url:"/diagnose/warningData/fetchAllData",method:"post",params:e})}var _={components:{Table:b},data:function(){return{searchForm:{date:"",dateType:"datetimerange",searchText:""},showOperation:!0,border:!0,columns:[],pageRequest:{pageNum:1,pageSize:15},pageResult:{},dealingPageRequest:{pageNum:1,pageSize:15},dealingPageResult:{},dataForm:{},downloadLoading:!1,allPagesData:null,dealedActive:!0,dealingActive:!1,dealedTable:!0,dealingTable:!1}},computed:{},mounted:function(){},methods:{findPage:function(e){var a=this;null!==e&&(this.pageRequest=e.pageRequest),this.pageRequest["filterUserName"]=this.searchForm.searchText,this.pageRequest["startTime"]=null===this.searchForm.date?null:this.searchForm.date[0],this.pageRequest["endTime"]=null===this.searchForm.date?null:this.searchForm.date[1],this.pageRequest["type"]=1,w(this.pageRequest).then((function(e){a.pageResult.content=e.warningDataList,a.pageResult.totalSize=e.warningDataListNumber})).then(null!=e?e.callback:"")},findDealingPage:function(e){var a=this;null!==e&&(this.dealingPageRequest=e.pageRequest),this.dealingPageRequest["filterUserName"]=this.searchForm.searchText,this.dealingPageRequest["startTime"]=null===this.searchForm.date?null:this.searchForm.date[0],this.dealingPageRequest["endTime"]=null===this.searchForm.date?null:this.searchForm.date[1],this.dealingPageRequest["type"]=0,w(this.dealingPageRequest).then((function(e){a.dealingPageResult.content=e.warningDataList,a.dealingPageResult.totalSize=e.warningDataListNumber})).then(null!=e?e.callback:"")},handleDelete:function(e){var a=this;R(e.row).then((function(t){!0===a.dealedTable?(a.pageResult.content.splice(e.index,1),a.pageResult.totalSize-=1):(a.dealingPageResult.content.splice(e.index,1),a.dealingPageResult.totalSize-=1),e.callback(t)})).catch((function(e){console.log(e)}))},handleEdit:function(e){var a=this;this.dataForm=e.row,y(e.row).then((function(e){if(!0===a.dealedTable){var t=a.pageResult.content.findIndex((function(e){return e.code===a.dataForm.code}));a.pageResult.content.splice(t,1)}else{var n=a.dealingPageResult.content.findIndex((function(e){return e.code===a.dataForm.code}));a.dealingPageResult.content.splice(n,1),a.$refs.dealedWarningDataTable.refreshPageRequest(a.pageRequest.pageNum)}a.$notify({title:"成功",message:e.msg,type:"success",duration:2e3})})).catch((function(e){console.log(e)}))},dateSearch:function(){!0===this.dealedTable?this.$refs.dealedWarningDataTable.refreshPageRequest(this.pageRequest.pageNum):this.$refs.dealingWarningDataTable.refreshPageRequest(this.dealingPageRequest.pageNum)},nameSearch:function(){!0===this.dealedTable?this.$refs.dealedWarningDataTable.refreshPageRequest(this.pageRequest.pageNum):this.$refs.dealingWarningDataTable.refreshPageRequest(this.dealingPageRequest.pageNum)},onExport:function(){var e=this,a=0;a=!0===this.dealedTable?1:0;var n={filterUserName:this.searchForm.searchText,startTime:null===this.searchForm.date?null:this.searchForm.date[0],endTime:null===this.searchForm.date?null:this.searchForm.date[1],type:a};this.downloadLoading=!0,T(n).then((function(n){e.allPagesData=n.warningDataList,Promise.all([t.e("chunk-6e83591c"),t.e("chunk-5164a781"),t.e("chunk-5bdd67a2"),t.e("chunk-54b312fe")]).then(t.bind(null,"4bf8d")).then((function(t){var n=["设备变量名称","设定报警值","处理状态","报警时间","设备名称","报警级别","实际值","数据单位"],l=["sheBeiVaribleName","alarmValue","state","alarmTime","sheBeiName","alarmLevel","currentValue","alarmUnit"],i=e.formatJson(l);t.export_json_to_excel({header:n,data:i,filename:0===a?"未处理报警数据表":"已处理报警数据表"}),e.downloadLoading=!1}))})).catch((function(e){console.log(e)}))},formatJson:function(e){return this.allPagesData.map((function(a){return e.map((function(e){return a[e]}))}))},handleTabClick:function(e){var a=e.currentTarget.dataset.id;switch(a){case"dealed":this.dealedActive=!0,this.dealingActive=!1,this.dealedTable=!0,this.dealingTable=!1;break;case"dealing":this.dealedActive=!1,this.dealingActive=!0,this.dealedTable=!1,this.dealingTable=!0;break;default:}}}},P=_,D=(t("5e84"),Object(u["a"])(P,n,l,!1,null,"30200d46",null));a["default"]=D.exports}}]);