(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-04ce031e"],{"0236":function(e,t,a){},"308b":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-button",{attrs:{size:e.size,type:e.type,icon:e.icon,loading:e.loading,disabled:e.disabled},on:{click:e.handleClick}},[e._v("\n  "+e._s(e.label)+"\n")])},i=[],l={name:"Button",props:{label:{type:String,default:""},icon:{type:String,default:""},size:{type:String,default:"mini"},type:{type:String,default:null},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},perms:{type:Boolean,default:null}},data:function(){return{}},mounted:function(){},methods:{handleClick:function(){this.$emit("click",{})}}},s=l,r=a("2877"),o=Object(r["a"])(s,n,i,!1,null,null,null);t["a"]=o.exports},"6dea":function(e,t,a){"use strict";var n=a("0236"),i=a.n(n);i.a},"71ca":function(e,t,a){"use strict";var n=a("d83d"),i=a.n(n);i.a},c67c:function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return l})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return r}));var n=a("a48f");function i(e){return Object(n["a"])({url:"/diagnose/warningData/getWarningDataList",method:"post",params:e})}function l(e){return Object(n["a"])({url:"/diagnose/warningData/updateWarningState",method:"post",params:e})}function s(e){return Object(n["a"])({url:"/diagnose/warningData/deleteWarningData",method:"post",params:e})}function r(e){return Object(n["a"])({url:"/diagnose/warningData/fetchAllData",method:"post",params:e})}},d83d:function(e,t,a){},f6d1:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"warningData-container"},[a("div",{staticClass:"search-container"},[a("div",{staticClass:"tabs-container"},[a("div",{staticClass:"tab tab-dealing",class:{active:e.dealingActive},attrs:{"data-id":"dealing"},on:{click:e.handleTabClick}},[e._v("未处理")]),e._v(" "),a("div",{staticClass:"tab tab-dealed",class:{active:e.dealedActive},attrs:{"data-id":"dealed"},on:{click:e.handleTabClick}},[e._v("已处理")])]),e._v(" "),a("div",{staticClass:"search-condition"},[a("el-date-picker",{staticStyle:{display:"inline-block"},attrs:{type:e.searchForm.dateType,"range-separator":"至",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期",placeholder:"选择时间","suffix-icon":"el-icon-search"},model:{value:e.searchForm.date,callback:function(t){e.$set(e.searchForm,"date",t)},expression:"searchForm.date"}}),e._v(" "),a("el-button",{staticClass:"btn-query",staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:e.dateSearch}},[e._v("查询")]),e._v(" "),a("el-input",{staticStyle:{width:"212px"},attrs:{placeholder:"请输入搜索内容","suffix-icon":"el-icon-search"},model:{value:e.searchForm.searchText,callback:function(t){e.$set(e.searchForm,"searchText",t)},expression:"searchForm.searchText"}}),e._v(" "),a("el-button",{staticClass:"btn-search",attrs:{type:"primary"},on:{click:e.nameSearch}},[e._v("搜索")]),e._v(" "),a("el-button",{staticClass:"btn-export",attrs:{loading:e.downloadLoading},on:{click:e.onExport}},[e._v("导出")])],1)]),e._v(" "),a("div",{staticClass:"table-container"},[a("Table",{directives:[{name:"show",rawName:"v-show",value:e.dealedTable,expression:"dealedTable"}],ref:"dealedWarningDataTable",attrs:{height:750,border:e.border,"show-operation":e.showOperation,data:e.pageResult},on:{findPage:e.findPage,handleEdit:e.handleEdit,handleDelete:e.handleDelete}}),e._v(" "),a("Table",{directives:[{name:"show",rawName:"v-show",value:e.dealingTable,expression:"dealingTable"}],ref:"dealingWarningDataTable",attrs:{height:750,border:e.border,"show-operation":e.showOperation,data:e.dealingPageResult},on:{findPage:e.findDealingPage,handleEdit:e.handleEdit,handleDelete:e.handleDelete}})],1)])},i=[],l=(a("20d6"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"table-container"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","font-size":"14px"},attrs:{data:e.data.content,"highlight-current-row":e.highlightCurrentRow,border:e.border,stripe:e.stripe,"show-overflow-tooltip":e.showOverflowTooltip,"max-height":e.maxHeight,height:e.height,size:e.size,align:e.align,"header-cell-style":{background:"#F1F4FD"}},on:{"selection-change":e.selectionChange,"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{prop:"faultSystem",label:"故障系统","min-width":"50","header-align":"center",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sheBeiName",label:"设备名称","min-width":"90","header-align":"center",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"pointAttribute",label:"参数点位","min-width":"50","header-align":"center",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"alarmTime",label:"报警时间","min-width":"60",sortable:!0,"header-align":"center",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"state",label:"处理状态","min-width":"50","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",{style:0===n.stateCode?"color:#F5222D;":"color:#606266;"},[e._v(e._s(n.state))])]}}],null,!1,2235348708)}),e._v(" "),e._e(),e._v(" "),e._e(),e._v(" "),e.showOperation?a("el-table-column",{attrs:{label:"报警操作","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Button",{attrs:{label:1===t.row.stateCode?"已处理":"消除",size:e.size,type:e.buttonType.success,disabled:1===t.row.stateCode},on:{click:function(a){return e.handleDealing(t.$index,t.row)}}}),e._v(" "),a("Button",{attrs:{label:"删除",size:e.size,type:e.buttonType.warning},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})]}}],null,!1,3168666553)}):e._e()],1),e._v(" "),a("div",{staticClass:"toolbar"},[a("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper","current-page":e.pageRequest.pageNum,"page-size":e.pageRequest.pageSize,total:e.data.totalSize},on:{"update:total":function(t){return e.$set(e.data,"totalSize",t)},"current-change":e.refreshPageRequest}})],1)],1)}),s=[],r=(a("c5f6"),a("308b")),o={name:"Table",components:{Button:r["a"]},props:{columns:{type:Array,default:null},data:{type:Object,default:null},size:{type:String,default:"mini"},align:{type:String,default:"left"},maxHeight:{type:Number,default:800},height:{type:Number,default:250},showOperation:{type:Boolean,default:!0},border:{type:Boolean,default:!1},stripe:{type:Boolean,default:!0},highlightCurrentRow:{type:Boolean,default:!0},showOverflowTooltip:{type:Boolean,default:!0},showBatchDelete:{type:Boolean,default:!0}},data:function(){return{pageRequest:{pageNum:1,pageSize:20},loading:!1,selections:[],buttonType:{success:"success",warning:"warning"}}},mounted:function(){this.refreshPageRequest(1)},methods:{refreshPageRequest:function(e){this.pageRequest.pageNum=e,this.findPage(),this.findDealingPage()},findPage:function(){var e=this;this.loading=!0;var t=function(t){e.loading=!1};this.$emit("findPage",{pageRequest:this.pageRequest,callback:t})},findDealingPage:function(){var e=this;this.loading=!0;var t=function(t){e.loading=!1};this.$emit("findDealingPage",{pageRequest:this.pageRequest,callback:t})},selectionChange:function(e){this.selections=e,this.$emit("selectionChange",{selections:e})},handleCurrentChange:function(e){this.$emit("handleCurrentChange",{val:e})},handleDealing:function(e,t){this.$emit("handleEdit",{index:e,row:t})},handleDelete:function(e,t){this.delete({index:e,row:t})},delete:function(e){var t=this;this.$confirm("确认屏蔽所选内容？","提示",{type:"warning"}).then((function(){var a=function(e){1===e.state?(t.$message({message:"删除成功",type:"success"}),t.findPage()):t.$message({message:"删除失败",type:"error"}),t.loading=!1};t.$emit("handleDelete",{rowInfor:e,callback:a}),t.loading=!1})).catch((function(){}))}}},d=o,c=(a("71ca"),a("2877")),u=Object(c["a"])(d,l,s,!1,null,null,null),h=u.exports,g=a("c67c"),p={components:{Table:h},data:function(){return{searchForm:{date:"",dateType:"datetimerange",searchText:""},showOperation:!1,border:!0,pageRequest:{pageNum:1,pageSize:20},pageResult:{},dealingPageRequest:{pageNum:1,pageSize:20},dealingPageResult:{},dataForm:{},downloadLoading:!1,allPagesData:null,dealedActive:!1,dealingActive:!0,dealedTable:!1,dealingTable:!0}},computed:{},mounted:function(){},methods:{findPage:function(e){var t=this;null!==e&&(this.pageRequest=e.pageRequest),this.pageRequest["filterUserName"]=this.searchForm.searchText,this.pageRequest["startTime"]=""===this.searchForm.date?null:this.searchForm.date[0],this.pageRequest["endTime"]=""===this.searchForm.date?null:this.searchForm.date[1],this.pageRequest["type"]=1,this.pageRequest["tableType"]=2,Object(g["c"])(this.pageRequest).then((function(e){t.pageResult.content=e.warningDataList,t.pageResult.totalSize=e.warningDataListNumber})).then(null!=e?e.callback:"")},findDealingPage:function(e){var t=this;null!==e&&(this.dealingPageRequest=e.pageRequest),this.dealingPageRequest["filterUserName"]=this.searchForm.searchText,this.dealingPageRequest["startTime"]=""===this.searchForm.date?null:this.searchForm.date[0],this.dealingPageRequest["endTime"]=""===this.searchForm.date?null:this.searchForm.date[1],this.dealingPageRequest["type"]=0,this.dealingPageRequest["tableType"]=2,Object(g["c"])(this.dealingPageRequest).then((function(e){t.dealingPageResult.content=e.warningDataList,t.dealingPageResult.totalSize=e.warningDataListNumber})).then(null!=e?e.callback:"")},handleDelete:function(e){var t=this;e.row["tableType"]=2,Object(g["a"])(e.row).then((function(a){!0===t.dealedTable?(t.pageResult.content.splice(e.index,1),t.pageResult.totalSize-=1):(t.dealingPageResult.content.splice(e.index,1),t.dealingPageResult.totalSize-=1),e.callback(a)})).catch((function(e){console.log(e)}))},handleEdit:function(e){var t=this;this.dataForm=e.row,e.row["tableType"]=2,Object(g["d"])(e.row).then((function(e){if(!0===t.dealedTable){var a=t.pageResult.content.findIndex((function(e){return e.code===t.dataForm.code}));t.pageResult.content.splice(a,1)}else{var n=t.dealingPageResult.content.findIndex((function(e){return e.code===t.dataForm.code}));t.dealingPageResult.content.splice(n,1),t.$refs.dealedWarningDataTable.refreshPageRequest(t.pageRequest.pageNum)}t.$notify({title:"成功",message:e.msg,type:"success",duration:2e3})})).catch((function(e){console.log(e)}))},dateSearch:function(){!0===this.dealedTable?this.$refs.dealedWarningDataTable.refreshPageRequest(this.pageRequest.pageNum):this.$refs.dealingWarningDataTable.refreshPageRequest(this.dealingPageRequest.pageNum)},nameSearch:function(){!0===this.dealedTable?this.$refs.dealedWarningDataTable.refreshPageRequest(this.pageRequest.pageNum):this.$refs.dealingWarningDataTable.refreshPageRequest(this.dealingPageRequest.pageNum)},onExport:function(){var e=this,t=0;t=!0===this.dealedTable?1:0;var n={filterUserName:this.searchForm.searchText,startTime:""===this.searchForm.date?null:this.searchForm.date[0],endTime:""===this.searchForm.date?null:this.searchForm.date[1],type:t,tableType:2};this.downloadLoading=!0,Object(g["b"])(n).then((function(n){e.allPagesData=n.warningDataList,Promise.all([a.e("chunk-6e83591c"),a.e("chunk-5164a781"),a.e("chunk-84ac2056"),a.e("chunk-0153a158")]).then(a.bind(null,"4bf8d")).then((function(a){var n=["故障系统","设备名称","参数点位","报警时间","处理状态"],i=["faultSystem","sheBeiName","pointAttribute","alarmTime","state"],l=e.formatJson(i);a.export_json_to_excel({header:n,data:l,filename:0===t?"离线报警未处理报警数据表":"离线报警已处理报警数据表"}),e.downloadLoading=!1}))})).catch((function(e){console.log(e)}))},formatJson:function(e){return this.allPagesData.map((function(t){return e.map((function(e){return t[e]}))}))},handleTabClick:function(e){var t=e.currentTarget.dataset.id;switch(t){case"dealed":this.dealedActive=!0,this.dealingActive=!1,this.dealedTable=!0,this.dealingTable=!1;break;case"dealing":this.dealedActive=!1,this.dealingActive=!0,this.dealedTable=!1,this.dealingTable=!0;break;default:}}}},f=p,m=(a("6dea"),Object(c["a"])(f,n,i,!1,null,"167f15d6",null));t["default"]=m.exports}}]);