(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-864495da"],{"366f":function(e,t,a){},"78d2":function(e,t,a){"use strict";var n=a("fccd"),l=a.n(n);l.a},"8cbc":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-button",{attrs:{size:e.size,type:e.type,icon:e.icon,loading:e.loading,disabled:e.perms},on:{click:e.handleClick}},[e._v("\n  "+e._s(e.label)+"\n")])},l=[],i={name:"PlatSettingButton",props:{label:{type:String,default:""},icon:{type:String,default:""},size:{type:String,default:"mini"},type:{type:String,default:null},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!0},perms:{type:String,default:null}},data:function(){return{}},mounted:function(){},methods:{handleClick:function(){this.$emit("click",{})}}},o=i,r=a("e90a"),s=Object(r["a"])(o,n,l,!1,null,null,null);t["a"]=s.exports},"9dd7":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"dutyMange"}},[a("div",{staticClass:"searchWord"},[a("el-button",{staticClass:"btn-new",attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新建值班")]),e._v(" "),a("div",{staticClass:"search-condition"},[a("el-date-picker",{staticStyle:{display:"inline-block"},attrs:{type:e.searchForm.dateType,"range-separator":"至",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期",placeholder:"选择时间","suffix-icon":"el-icon-search"},model:{value:e.searchForm.date,callback:function(t){e.$set(e.searchForm,"date",t)},expression:"searchForm.date"}}),e._v(" "),a("el-button",{staticClass:"btn-query",staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:e.dateSearch}},[e._v("查询")]),e._v(" "),a("el-input",{staticStyle:{width:"212px"},attrs:{placeholder:"请输入值班人员姓名搜索","suffix-icon":"el-icon-search"},model:{value:e.searchForm.searchText,callback:function(t){e.$set(e.searchForm,"searchText",t)},expression:"searchForm.searchText"}}),e._v(" "),a("el-button",{staticClass:"btn-search",attrs:{type:"primary"},on:{click:e.nameSearch}},[e._v("搜索")]),e._v(" "),a("el-button",{staticClass:"btn-export",on:{click:e.onExport}},[e._v("导出")])],1)],1),e._v(" "),a("div",{staticClass:"table-container"},[a("platSettingTable",{ref:"dutyTable",attrs:{height:750,border:e.border,"show-operation":e.showOperation,data:e.pageResult,columns:e.columns},on:{findPage:e.findPage,handleEdit:e.handleEdit,handleDelete:e.handleDelete}})],1),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"dutyDialog",attrs:{title:e.operation?"新建值班信息":"修改值班信息",width:"40%",visible:e.dialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{model:e.dataForm,"label-width":"auto",rules:e.dataFormRules,"label-position":"top"}},[a("div",{staticClass:"row row-0"},[a("el-form-item",{attrs:{label:"值班领导",prop:"LEADER_USER_NAME"}},[a("el-autocomplete",{attrs:{disabled:!1,"fetch-suggestions":e.queryLeaderSearchAsync,"trigger-on-focus":!1,"auto-complete":"请输入值班领导"},on:{select:e.leaderSelect},model:{value:e.dataForm.LEADER_USER_NAME,callback:function(t){e.$set(e.dataForm,"LEADER_USER_NAME",t)},expression:"dataForm.LEADER_USER_NAME"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"值班人员",prop:"DUTY_UER_NAME"}},[a("el-autocomplete",{attrs:{disabled:!1,"fetch-suggestions":e.queryDutyMemberSearchAsync,"trigger-on-focus":!1,"auto-complete":"请输入值班人员"},on:{select:e.dutyMemberSelect},model:{value:e.dataForm.DUTY_UER_NAME,callback:function(t){e.$set(e.dataForm,"DUTY_UER_NAME",t)},expression:"dataForm.DUTY_UER_NAME"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"值班类型",prop:"DUTY_TYPE"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择值班类型"},on:{change:e.selectChanged},model:{value:e.dataForm.DUTY_TYPE_NAME,callback:function(t){e.$set(e.dataForm,"DUTY_TYPE_NAME",t)},expression:"dataForm.DUTY_TYPE_NAME"}},e._l(e.dutyTypes,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:{value:e.value,label:e.label}}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"系统",prop:"SYSTEMNAME"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择系统"},on:{change:e.systemSelect},model:{value:e.dataForm.SYSTEMNAME,callback:function(t){e.$set(e.dataForm,"SYSTEMNAME",t)},expression:"dataForm.SYSTEMNAME"}},e._l(e.systemSuggestion,(function(e){return a("el-option",{key:e.DEVICE_CODE,attrs:{label:e.value,value:{value:e.DEVICE_CODE,label:e.value}}})})),1)],1)],1),e._v(" "),a("div",{staticClass:"row row-1",staticStyle:{width:"100%"}},[a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"值班内容",prop:"CONTENT"}},[a("el-input",{attrs:{type:"textarea",maxlength:"100","show-word-limit":"",disabled:!1,"auto-complete":"请输入值班内容"},model:{value:e.dataForm.CONTENT,callback:function(t){e.$set(e.dataForm,"CONTENT",t)},expression:"dataForm.CONTENT"}})],1)],1)]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{loading:e.editLoading,type:"primary"},on:{click:function(t){"create"===e.dialogStatus?e.createData():e.updateData("dataForm")}}},[e._v("提交")]),e._v(" "),a("el-button",{on:{click:function(t){return e.resetForm("dataForm")}}},[e._v("重置")])],1)],1)],1)},l=[],i=(a("e204"),a("d03d")),o=a("a48f");function r(e){return Object(o["a"])({url:"/setting/dutyManage/findDutyListByPage",method:"post",params:e})}function s(e){return Object(o["a"])({url:"/setting/dutyManage/createDuty",method:"post",params:e})}function u(e){return Object(o["a"])({url:"/setting/dutyManage/updateDuty",method:"post",params:e})}function c(e){return Object(o["a"])({url:"/setting/dutyManage/deleteDuty",method:"post",params:e})}function d(e){return Object(o["a"])({url:"/setting/dutyManage/searchDutyUser",method:"post",params:e})}function h(e){return Object(o["a"])({url:"/setting/dutyManage/searchSystem",method:"post",params:e})}function p(e){return Object(o["a"])({url:"/setting/dutyManage/fetchAllData",method:"post",params:e})}var m=a("ed08"),g={components:{platSettingTable:i["a"]},data:function(){return{showOperation:!0,border:!0,columns:[],pageRequest:{pageNum:1,pageSize:10},pageResult:{},operation:!1,dialogVisible:!1,editLoading:!1,dialogStatus:"",dataFormRules:{LEADER_USER_NAME:[{required:!0,message:"请输入值班领导",trigger:"blur"}],DUTY_UER_NAME:[{required:!0,message:"请选择值班人员",trigger:"change"}],DUTY_TYPE:[{required:!0,message:"请选择值班类型",trigger:"change"}]},searchForm:{date:"",dateType:"datetimerange",searchText:""},dataForm:{CODE:null,LEADER_USER:null,LEADER_USER_NAME:null,DUTY_TYPE:null,DUTY_TYPE_NAME:null,DUTY_UER:null,DUTY_UER_NAME:null,CONTENT:null,SYSTEMCODE:null,SYSTEMNAME:null,SUMMIT_TIME:null},dutyTypes:[{value:"0",label:"早班"},{value:"1",label:"午班"},{value:"2",label:"晚班"}],dutyUserSuggestion:[],systemSuggestion:[],downloadLoading:!1,allPagesData:null}},computed:{},mounted:function(){this.initColumns(),this.searchInputLeader(),this.searchInputSystem()},methods:{searchInputLeader:function(){var e=this;d().then((function(t){e.dutyUserSuggestion=t.data})).catch((function(e){console.log(e)}))},searchInputSystem:function(){var e=this;h().then((function(t){e.systemSuggestion=t.data})).catch((function(e){console.log(e)}))},leaderSelect:function(e){this.dataForm.LEADER_USER=e.USER_NAME,this.dataForm.LEADER_USER_NAME=e.value},queryLeaderSearchAsync:function(e,t){var a=this.dutyUserSuggestion,n=e?a.filter(this.createStateFilter(e)):a;t(n)},dutyMemberSelect:function(e){this.dataForm.DUTY_UER=e.USER_NAME,this.dataForm.DUTY_UER_NAME=e.value},queryDutyMemberSearchAsync:function(e,t){var a=this.dutyUserSuggestion,n=e?a.filter(this.createStateFilter(e)):a;t(n)},systemSelect:function(e){this.dataForm.SYSTEMCODE=e.value,this.dataForm.SYSTEMNAME=e.label},createStateFilter:function(e){return function(t){return 0===t.value.indexOf(e)}},selectChanged:function(e){var t=e.value,a=e.label;this.dataForm.DUTY_TYPE=t,this.dataForm.DUTY_TYPE_NAME=a},createData:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){var a=Object(m["f"])(new Date);e.dataForm.SUMMIT_TIME=a,s(e.dataForm).then((function(t){e.dataForm.CODE=t.newID,e.pageResult.content.unshift(e.dataForm),e.pageResult.totalSize+=1,e.dialogVisible=!1,e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3})})).catch((function(e){console.log(e)}))}}))},updateData:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;var a=Object(m["f"])(new Date);t.dataForm.SUMMIT_TIME=a,u(t.dataForm).then((function(e){var a=t.pageResult.content.findIndex((function(e){return e.CODE===t.dataForm.CODE}));t.pageResult.content.splice(a,1,t.dataForm),t.dialogVisible=!1,t.$notify({title:"成功",message:"更新值班成功",type:"success",duration:2e3})})).catch((function(e){console.log(e)}))}))},resetForm:function(e){this.$refs[e].resetFields(),this.dialogVisible=!1},initColumns:function(){this.columns=[{prop:"CODE",label:"编号",minWidth:50,show:!1},{prop:"LEADER_USER",label:"值班领导",minWidth:50,show:!1},{prop:"LEADER_USER_NAME",label:"值班领导",minWidth:50,show:!0},{prop:"DUTY_TYPE",label:"值班类型",minWidth:50,show:!1},{prop:"DUTY_TYPE_NAME",label:"值班类型",minWidth:50,show:!0},{prop:"DUTY_UER",label:"值班人员",minWidth:100,show:!1},{prop:"DUTY_UER_NAME",label:"值班人员",minWidth:100,show:!0},{prop:"CONTENT",label:"值班内容",minWidth:100,show:!0},{prop:"SYSTEMNAME",label:"值班系统",minWidth:100,show:!0},{prop:"SUMMIT_TIME",label:"值班时间",minWidth:50,show:!0}]},findPage:function(e){var t=this;null!==e&&(this.pageRequest=e.pageRequest),this.pageRequest["filterUserName"]=this.searchForm.searchText,this.pageRequest["startTime"]=null===this.searchForm.date?null:this.searchForm.date[0],this.pageRequest["endTime"]=null===this.searchForm.date?null:this.searchForm.date[1],r(this.pageRequest).then((function(e){t.pageResult.content=e.dutyList,t.pageResult.totalSize=e.dutyListNumber})).then(null!=e?e.callback:"")},handleAdd:function(){this.dialogStatus="create",this.dialogVisible=!0,this.operation=!0,this.dataForm={}},handleDelete:function(e){var t=this;c(e.rowInfor.row).then((function(a){t.pageResult.content.splice(e.rowInfor.index,1),t.pageResult.totalSize-=1,e.callback(a)})).catch((function(e){console.log(e)}))},handleEdit:function(e){this.dialogStatus="edit",this.dialogVisible=!0,this.operation=!1,this.dataForm=Object.assign({},e.row)},dateSearch:function(){this.$refs.dutyTable.refreshPageRequest(this.pageRequest.pageNum)},nameSearch:function(){this.$refs.dutyTable.refreshPageRequest(this.pageRequest.pageNum)},onExport:function(){var e=this,t={filterUserName:this.searchForm.searchText,startTime:null===this.searchForm.date?null:this.searchForm.date[0],endTime:null===this.searchForm.date?null:this.searchForm.date[1]};p(t).then((function(t){e.downloadLoading=!0,e.allPagesData=t.dutyList,Promise.all([a.e("chunk-87d7ce5a"),a.e("chunk-45f5f85e"),a.e("chunk-4e4e74e6"),a.e("chunk-18a5a462")]).then(a.bind(null,"4bf8d")).then((function(t){var a=["值班领导","值班类型","值班人员","值班内容","值班系统","值班时间"],n=["LEADER_USER_NAME","DUTY_TYPE_NAME","DUTY_UER_NAME","CONTENT","SYSTEMNAME","SUMMIT_TIME"],l=e.formatJson(n);t.export_json_to_excel({header:a,data:l,filename:"值班数据表"}),e.downloadLoading=!1}))})).catch((function(e){console.log(e)}))},formatJson:function(e){return this.allPagesData.map((function(t){return e.map((function(e){return t[e]}))}))}}},f=g,E=(a("78d2"),a("e90a")),b=Object(E["a"])(f,n,l,!1,null,"537f9faa",null);t["default"]=b.exports},d03d:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"table-container"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","font-size":"14px"},attrs:{data:e.data.content,"highlight-current-row":e.highlightCurrentRow,border:e.border,stripe:e.stripe,"show-overflow-tooltip":e.showOverflowTooltip,"max-height":e.maxHeight,height:e.height,size:e.size,align:e.align,"header-cell-style":{background:"#F1F4FD"}},on:{"selection-change":e.selectionChange,"current-change":e.handleCurrentChange}},[e._l(e.columns,(function(t){return[t.show?a("el-table-column",{key:t.prop,attrs:{prop:t.prop,label:t.label,width:t.width,"min-width":t.minWidth,sortable:null!=t.sortable&&t.sortable,"header-align":"center",align:"center"}}):e._e()]})),e._v(" "),e.showOperation?a("el-table-column",{attrs:{label:"操作","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("platSettingButton",{attrs:{icon:"el-icon-edit",label:"编辑",size:e.size},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("platSettingButton",{attrs:{icon:"el-icon-delete",label:"删除",size:e.size,type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})]}}],null,!1,2036310822)}):e._e()],2),e._v(" "),a("div",{staticClass:"toolbar"},[a("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper","current-page":e.pageRequest.pageNum,"page-size":e.pageRequest.pageSize,total:e.data.totalSize},on:{"update:total":function(t){return e.$set(e.data,"totalSize",t)},"current-change":e.refreshPageRequest}})],1)],1)},l=[],i=(a("163d"),a("8cbc")),o={name:"PlatSettingTable",components:{platSettingButton:i["a"]},props:{columns:{type:Array,default:null},data:{type:Object,default:null},size:{type:String,default:"mini"},align:{type:String,default:"left"},maxHeight:{type:Number,default:800},height:{type:Number,default:250},showOperation:{type:Boolean,default:!0},border:{type:Boolean,default:!1},stripe:{type:Boolean,default:!0},highlightCurrentRow:{type:Boolean,default:!0},showOverflowTooltip:{type:Boolean,default:!0},showBatchDelete:{type:Boolean,default:!0}},data:function(){return{pageRequest:{pageNum:1,pageSize:15},loading:!1,selections:[]}},mounted:function(){this.refreshPageRequest(1)},methods:{refreshPageRequest:function(e){this.pageRequest.pageNum=e,this.findPage()},findPage:function(){var e=this;this.loading=!0;var t=function(t){e.loading=!1};this.$emit("findPage",{pageRequest:this.pageRequest,callback:t})},selectionChange:function(e){this.selections=e,this.$emit("selectionChange",{selections:e})},handleCurrentChange:function(e){this.$emit("handleCurrentChange",{val:e})},handleEdit:function(e,t){this.$emit("handleEdit",{index:e,row:t})},handleDelete:function(e,t){this.delete({index:e,row:t})},delete:function(e){var t=this;this.$confirm("确认删除所选内容？","提示",{type:"warning"}).then((function(){var a=function(e){1===e.state?(t.$message({message:"删除成功",type:"success"}),t.findPage()):t.$message({message:"删除失败",type:"error"}),t.loading=!1};t.$emit("handleDelete",{rowInfor:e,callback:a}),t.loading=!1})).catch((function(){}))}}},r=o,s=(a("de9b"),a("e90a")),u=Object(s["a"])(r,n,l,!1,null,null,null);t["a"]=u.exports},de9b:function(e,t,a){"use strict";var n=a("366f"),l=a.n(n);l.a},fccd:function(e,t,a){}}]);